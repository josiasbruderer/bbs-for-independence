---
title: "Textfiles.com Analysis"
output:
  html_document:
    df_print: kable
editor_options:
  chunk_output_type: console
---
# Preparation

```{r message=FALSE, warning=FALSE}
# install stuff that we need later
if (!require("DT")) install.packages('DT')
if (!require("ggplot2")) install.packages('ggplot2')
if (!require("tidyverse")) install.packages('tidyverse')
if (!require("hrbrthemes")) install.packages('hrbrthemes')
if (!require("dplyr")) install.packages('dplyr')

# Load stuff we need later
library(readr)
library(DT)
library(ggplot2)
library(tidyverse)
library(hrbrthemes)
library(dplyr)

# and set the working directory
setwd("~/projects/bbs-for-independence/03_workspace")
```

# Import Data

```{r}
# Read dataset summary from csv
dataset <- read_csv("../.tmp/dataset.csv", show_col_types = FALSE)
dataset$charratioDelta = dataset$charratioB - dataset$charratioA
```

# Prepare Data

```{r}
# Check the average of length, length_raw, avgcolumnsize, charratioA and charratioB
groups = aggregate(dataset[, c(4,5,6,7,8,13)], list(dataset$category), FUN = function(x) round(mean(suppressWarnings(as.numeric(as.character(x))), na.rm=TRUE), digits = 2))

cat("Anzahl Dateien: ", nrow(dataset))
cat("Anzahl Kategorien: ", nrow(groups))

groups %>% arrange(desc(charratioB))
```

\newpage

# Plots
 
## Verhältnis Text (exkl. Satz- und Leerzeichen) zu Sonderzeichen

```{r, fig.width=8, fig.height=10}
dataset %>%
  ggplot( aes(x=reorder(category, charratioA, FUN = median), 
              y=charratioA, group=category)) +
    geom_boxplot() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    geom_jitter(color="black", size=0.4, alpha=0.05) +
    stat_summary(fun.y=mean, geom="point", shape=4, size=2, color="red", fill="red") +
    coord_flip() + 
    ylim(0, 1) +
    xlab("Kategorie") +
    ylab("Verhältnis")
```

## Verhältnis Text (inkl. Satz- und Leerzeichen) zu Sonderzeichen

```{r, fig.width=8, fig.height=10}
# create plot: charratioB
dataset %>%
  ggplot( aes(x=reorder(category, charratioB, FUN = median), 
              y=charratioB, group=category)) +
    geom_boxplot() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    geom_jitter(color="black", size=0.4, alpha=0.05) +
    stat_summary(fun.y=mean, geom="point", shape=4, size=2, color="red", fill="red") +
    coord_flip() + 
    ylim(0, 1) +
    xlab("Kategorie") +
    ylab("Verhältnis")
```

## Differenz beiden Verhältnissen (inkl. minus exkl. Satz- und Leerzeichen zu Sonderzeichen)

```{r, fig.width=8, fig.height=10}
dataset %>%
  ggplot( aes(x=reorder(category, charratioA-charratioB, FUN = median), 
              y=charratioB-charratioA, group=category)) +
    geom_boxplot() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    geom_jitter(color="black", size=0.4, alpha=0.05) +
    stat_summary(fun.y=mean, geom="point", shape=4, size=2, color="red", fill="red") +
    coord_flip() + 
    ylim(0, 1) +
    xlab("Kategorie") +
    ylab("Differenz beiden Verhältnissen")
```

