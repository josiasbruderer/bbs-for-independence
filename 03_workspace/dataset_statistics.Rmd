---
title: "Textfiles.com Analysis"
output:
  html_document:
    df_print: paged
editor_options:
  chunk_output_type: console
---
# Preparation

```{r message=FALSE, warning=FALSE}
# install stuff that we need later
if (!require("DT")) install.packages('DT')
if (!require("ggplot2")) install.packages('ggplot2')
if (!require("tidyverse")) install.packages('tidyverse')
if (!require("hrbrthemes")) install.packages('hrbrthemes')
if (!require("viridis")) install.packages('viridis')
if (!require("dplyr")) install.packages('dplyr')

# Load stuff we need later
library(readr)
library(DT)
library(ggplot2)
library(tidyverse)
library(hrbrthemes)
library(viridis)
library(dplyr)

# and set the working directory
setwd("~/projects/bbs-for-independence/03_workspace")
```

# Import Data

```{r}
# Read dataset summary from csv
dataset <- read_csv("../.tmp/dataset.csv", show_col_types = FALSE)
```

# Prepare Data

```{r}
# Check the average of length, length_raw, avgcolumnsize, charratioA and charratioB
groups = aggregate(dataset[, 3:7], list(dataset$category), FUN = function(x) mean(suppressWarnings(as.numeric(as.character(x))), na.rm=TRUE))

datatable(groups)
```

# Plots
 
```{r, fig.width=8, fig.height=12}
# create plot: charratioA
dataset %>%
  ggplot( aes(x=reorder(category, charratioA, FUN = median), 
              y=charratioA, group=category)) +
    geom_boxplot() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    geom_jitter(color="black", size=0.4, alpha=0.05) +
    coord_flip() +
    xlab("Kategorie") +
    ylab("Verhältnis Text (exkl. Satz- und Leerzeichen)/Sonderzeichen")

# create plot: charratioB
dataset %>%
  ggplot( aes(x=reorder(category, charratioB, FUN = median), 
              y=charratioA, group=category)) +
    geom_boxplot() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    geom_jitter(color="black", size=0.4, alpha=0.05) +
    coord_flip() +
    xlab("Kategorie") +
    ylab("Verhältnis Text (inkl. Satz- und Leerzeichen)/Sonderzeichen")


# create plot: charratioA - charratioB
dataset %>%
  ggplot( aes(x=reorder(category, charratioA-charratioB, FUN = median), 
              y=charratioA-charratioB, group=category)) +
    geom_boxplot() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    geom_jitter(color="black", size=0.4, alpha=0.05) +
    coord_flip() +
    xlab("Kategorie") +
    ylab("Differenz beiden Verhältnissen")

```

